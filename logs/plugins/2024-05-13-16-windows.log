2024-05-13 16:53:06.141956309 Info Inside the Collect method
2024-05-13 16:53:06.14215343 Info Executing command number: 5
2024-05-13 16:53:06.142270798 Info Executing command number: 5
2024-05-13 16:53:06.142359999 Info Executing command number: 5
2024-05-13 16:53:06.142361456 Info Executing command number: 5
2024-05-13 16:53:06.142564286 Info Executing command number: 5
2024-05-13 16:53:06.142687554 Info Executing command number: 5
2024-05-13 16:53:33.933197751 Info Inside the Collect method
2024-05-13 16:53:33.933361897 Info Executing command number: 5
2024-05-13 16:53:33.933449742 Info Executing command number: 5
2024-05-13 16:53:33.933424204 Info Executing command number: 5
2024-05-13 16:53:33.933753584 Info Executing command number: 5
2024-05-13 16:53:33.933765634 Info Executing command number: 5
2024-05-13 16:53:33.933880478 Info Executing command number: 5
2024-05-13 16:54:03.962595576 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 16:54:03.962532799 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 16:54:03.962660044 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 16:54:03.96315731 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:03.963135207 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:03.963138684 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:03.963636873 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 16:54:03.963664602 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-13 16:54:03.963676644 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 16:54:03.963932024 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:03.964009064 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:03.964030149 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:47.274029751 Info Inside the Collect method
2024-05-13 16:54:47.274197398 Info Executing command number: 5
2024-05-13 16:54:47.274325177 Info Executing command number: 5
2024-05-13 16:54:47.274370721 Info Executing command number: 5
2024-05-13 16:54:47.27440664 Info Executing command number: 5
2024-05-13 16:54:47.274567076 Info Executing command number: 5
2024-05-13 16:54:47.274676933 Info Executing command number: 5
2024-05-13 16:54:48.863042373 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 16:54:48.863027002 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-13 16:54:48.86303608 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 16:54:48.863557908 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:48.863568677 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:48.863722635 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:48.864011384 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 16:54:48.863412111 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 16:54:48.86409131 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 16:54:48.864339165 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:48.864339493 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:54:48.86447342 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:01.26929059 Info Inside the Collect method
2024-05-13 16:56:01.269467446 Info Executing command number: 5
2024-05-13 16:56:01.269553097 Info Executing command number: 5
2024-05-13 16:56:01.269646134 Info Executing command number: 5
2024-05-13 16:56:01.269705495 Info Executing command number: 5
2024-05-13 16:56:01.269884896 Info Executing command number: 5
2024-05-13 16:56:01.269984606 Info Executing command number: 5
2024-05-13 16:56:02.018278862 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-13 16:56:02.018270278 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 16:56:02.018301649 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 16:56:02.018497211 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:02.018502715 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:02.018510107 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:02.018635284 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 16:56:02.018733056 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:02.018711831 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 16:56:02.018920454 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 16:56:02.018944228 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:02.019082851 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:56:41.478342526 Info Inside the Collect method
2024-05-13 16:56:41.478510878 Info Executing command number: 5
2024-05-13 16:56:41.478665544 Info Executing command number: 5
2024-05-13 16:56:41.478714502 Info Executing command number: 5
2024-05-13 16:56:41.478723909 Info Executing command number: 5
2024-05-13 16:56:41.478858354 Info Executing command number: 5
2024-05-13 16:56:41.479110617 Info Executing command number: 5
2024-05-13 16:57:11.506507285 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 16:57:11.507034592 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 16:57:11.507142528 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:57:11.507408186 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:57:11.507604155 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-13 16:57:11.507652362 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 16:57:11.507675819 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 16:57:11.507900136 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 16:57:11.507977238 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:57:11.507977222 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:57:11.50802771 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:57:11.508267296 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:06.561644484 Info Inside the Collect method
2024-05-13 16:58:06.561825284 Info Executing command number: 5
2024-05-13 16:58:06.561966099 Info Executing command number: 5
2024-05-13 16:58:06.562027899 Info Executing command number: 5
2024-05-13 16:58:06.562212462 Info Executing command number: 5
2024-05-13 16:58:06.562384915 Info Executing command number: 5
2024-05-13 16:58:06.562397946 Info Executing command number: 5
2024-05-13 16:58:12.223025964 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 16:58:12.222980041 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 16:58:12.223556645 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:12.223531471 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:12.22402966 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 16:58:12.22403163 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 16:58:12.22434371 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:12.224343693 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:12.223769579 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-13 16:58:12.224725711 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 16:58:12.225009354 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]

2024-05-13 16:58:12.225434886 Info map[ip:192.168.82.18 password:dhyani port:5985 request.timeout.nanoseconds:30s request.type:collect username:Dhyani]


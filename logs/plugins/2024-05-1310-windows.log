2024-05-13 10:32:00.219336969 Info Inside the Collect method
2024-05-13 10:32:00.219587924 Info Executing command number: 5
2024-05-13 10:32:00.220000792 Info Executing command number: 5
2024-05-13 10:32:00.219855523 Info Executing command number: 5
2024-05-13 10:32:00.219983583 Info Executing command number: 5
2024-05-13 10:32:00.219959174 Info Executing command number: 5
2024-05-13 10:32:00.220451684 Info Executing command number: 5
2024-05-13 10:32:04.296029954 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("systems.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("System.Processor.Queue.Length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("Started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 10:32:04.296387513 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -expandproperty countersamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk()\% Idle Time")  | Select-Object -expandproperty countersamples | Select-Object @{Name='IOTimePercent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property IOTimePercent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(total)\Avg. Disk Bytes/Transfer" | Select-Object -expandproperty countersamples  | Select-Object @{Name='DiskIOBytesPerSecond';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 10:32:04.296384269 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second: " + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent: " + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("disk.io.read.bytes.per.sec: "  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 10:32:04.296663277 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:32:04.296052403 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.Bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}}  |fl;

2024-05-13 10:32:04.297294311 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:32:04.297487189 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:32:04.29772293 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:32:04.297472296 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface()\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 10:32:04.298263514 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -expandproperty countersamples |  Select-Object @{Name='ProcessorIdleTimePercent';Expression={($_.CookedValue)}} | Format-List;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -expandproperty countersamples |  Select-Object @{Name='CPUInterruptPercent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent: "  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 10:32:04.298499653 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:32:04.298617881 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:39:32.381058946 Info Inside the Collect method
2024-05-13 10:39:32.381266516 Info Executing command number: 5
2024-05-13 10:39:32.381461851 Info Executing command number: 5
2024-05-13 10:39:32.381399767 Info Executing command number: 5
2024-05-13 10:39:32.381637699 Info Executing command number: 5
2024-05-13 10:39:32.381817698 Info Executing command number: 5
2024-05-13 10:39:32.381932786 Info Executing command number: 5
2024-05-13 10:52:17.382429747 Info Inside the Collect method
2024-05-13 10:52:17.382629162 Info Executing command number: 5
2024-05-13 10:52:17.382845567 Info Executing command number: 5
2024-05-13 10:52:17.382957811 Info Executing command number: 5
2024-05-13 10:52:17.383030555 Info Executing command number: 5
2024-05-13 10:52:17.383200868 Info Executing command number: 5
2024-05-13 10:52:17.38331496 Info Executing command number: 5
2024-05-13 10:52:20.455874752 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second: " + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent: " + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("disk.io.read.bytes.per.sec: "  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 10:52:20.456304896 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface()\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 10:52:20.456300351 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -expandproperty countersamples |  Select-Object @{Name='ProcessorIdleTimePercent';Expression={($_.CookedValue)}} | Format-List;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -expandproperty countersamples |  Select-Object @{Name='CPUInterruptPercent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent: "  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 10:52:20.45656255 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:52:20.456645461 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:52:20.456825232 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:52:20.455888976 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.Bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}}  |fl;

2024-05-13 10:52:20.455898911 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("systems.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("System.Processor.Queue.Length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("Started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 10:52:20.457119328 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -expandproperty countersamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk()\% Idle Time")  | Select-Object -expandproperty countersamples | Select-Object @{Name='IOTimePercent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property IOTimePercent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(total)\Avg. Disk Bytes/Transfer" | Select-Object -expandproperty countersamples  | Select-Object @{Name='DiskIOBytesPerSecond';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 10:52:20.457232967 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:52:20.457450887 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:52:20.457475035 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:54:18.806321536 Info Inside the Collect method
2024-05-13 10:54:18.80644879 Info Executing command number: 5
2024-05-13 10:54:18.806685611 Info Executing command number: 5
2024-05-13 10:54:18.806930262 Info Executing command number: 5
2024-05-13 10:54:18.806915794 Info Executing command number: 5
2024-05-13 10:54:18.806973816 Info Executing command number: 5
2024-05-13 10:54:18.807171913 Info Executing command number: 5
2024-05-13 10:55:14.781640538 Info Inside the Collect method
2024-05-13 10:55:14.781838822 Info Executing command number: 5
2024-05-13 10:55:14.781942634 Info Executing command number: 5
2024-05-13 10:55:14.782087107 Info Executing command number: 5
2024-05-13 10:55:14.782232567 Info Executing command number: 5
2024-05-13 10:55:14.782402892 Info Executing command number: 5
2024-05-13 10:55:14.782399525 Info Executing command number: 5
2024-05-13 10:56:05.788366507 Info Inside the Collect method
2024-05-13 10:56:05.78859768 Info Executing command number: 5
2024-05-13 10:56:05.78879439 Info Executing command number: 5
2024-05-13 10:56:05.78892446 Info Executing command number: 5
2024-05-13 10:56:05.788750196 Info Executing command number: 5
2024-05-13 10:56:05.789280465 Info Executing command number: 5
2024-05-13 10:56:05.788778251 Info Executing command number: 5
2024-05-13 10:56:40.363044991 Error Error while making connection for command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.Bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}}  |fl;

2024-05-13 10:56:40.363185605 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:56:46.503954038 Error Error while making connection for command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -expandproperty countersamples |  Select-Object @{Name='ProcessorIdleTimePercent';Expression={($_.CookedValue)}} | Format-List;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -expandproperty countersamples |  Select-Object @{Name='CPUInterruptPercent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent: "  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-13 10:56:46.504287728 Error Error while making connection for command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second: " + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent: " + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("disk.io.read.bytes.per.sec: "  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-13 10:56:46.50393908 Error Error while making connection for command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface()\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-13 10:56:46.504626921 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:56:46.504695087 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:56:46.503964702 Error Error while making connection for command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -expandproperty countersamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk()\% Idle Time")  | Select-Object -expandproperty countersamples | Select-Object @{Name='IOTimePercent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property IOTimePercent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;Get-Counter -Counter "\PhysicalDisk(total)\Avg. Disk Bytes/Transfer" | Select-Object -expandproperty countersamples  | Select-Object @{Name='DiskIOBytesPerSecond';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-13 10:56:46.504741463 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:56:46.505142872 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:56:46.504286528 Error Error while making connection for command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("systems.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("System.Processor.Queue.Length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("Started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-13 10:56:46.505796117 Info map[ipAddress:192.168.137.30 password:dhyani port:5985 request.timeout:30s request.type:collect username:Dhyani]

2024-05-13 10:57:28.694525037 Info Inside the Collect method
2024-05-13 10:57:28.694724193 Info Executing command number: 5
2024-05-13 10:57:28.694927536 Info Executing command number: 5
2024-05-13 10:57:28.695103267 Info Executing command number: 5
2024-05-13 10:57:28.695437047 Info Executing command number: 5
2024-05-13 10:57:28.695775258 Info Executing command number: 5
2024-05-13 10:57:28.695101292 Info Executing command number: 5
2024-05-13 10:59:16.541240285 Info Inside the Collect method
2024-05-13 10:59:16.54144705 Info Executing command number: 5
2024-05-13 10:59:16.541578665 Info Executing command number: 5
2024-05-13 10:59:16.541870754 Info Executing command number: 5
2024-05-13 10:59:16.542170052 Info Executing command number: 5
2024-05-13 10:59:16.54239959 Info Executing command number: 5
2024-05-13 10:59:16.54243764 Info Executing command number: 5
